!function(n){var r={};function o(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}o.m=n,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/",o(o.s=5)}({3:function(t,e,n){var r=function(i){"use strict";var u,t=Object.prototype,l=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",r=e.toStringTag||"@@toStringTag";function a(t,e,n,r){var o=e&&e.prototype instanceof c?e:c,i=Object.create(o.prototype),a=new M(r||[]);return i._invoke=function(i,a,c){var u=d;return function(t,e){if(u===f)throw new Error("Generator is already running");if(u===m){if("throw"===t)throw e;return q()}for(c.method=t,c.arg=e;;){var n=c.delegate;if(n){var r=x(n,c);if(r){if(r===v)continue;return r}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(u===d)throw u=m,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);u=f;var o=s(i,a,c);if("normal"===o.type){if(u=c.done?m:h,o.arg===v)continue;return{value:o.arg,done:c.done}}"throw"===o.type&&(u=m,c.method="throw",c.arg=o.arg)}}}(t,n,a),i}function s(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=a;var d="suspendedStart",h="suspendedYield",f="executing",m="completed",v={};function c(){}function p(){}function y(){}var g={};g[o]=function(){return this};var b=Object.getPrototypeOf,w=b&&b(b(T([])));w&&w!==t&&l.call(w,o)&&(g=w);var _=y.prototype=c.prototype=Object.create(g);function L(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function E(u){var e;this._invoke=function(n,r){function t(){return new Promise(function(t,e){!function e(t,n,r,o){var i=s(u[t],u,n);if("throw"!==i.type){var a=i.arg,c=a.value;return c&&"object"==typeof c&&l.call(c,"__await")?Promise.resolve(c.__await).then(function(t){e("next",t,r,o)},function(t){e("throw",t,r,o)}):Promise.resolve(c).then(function(t){a.value=t,r(a)},function(t){return e("throw",t,r,o)})}o(i.arg)}(n,r,t,e)})}return e=e?e.then(t,t):t()}}function x(t,e){var n=t.iterator[e.method];if(n===u){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=u,x(t,e),"throw"===e.method))return v;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var r=s(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,v;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=u),e.delegate=null,v):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function M(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(l.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=u,t.done=!0,t};return r.next=r}}return{next:q}}function q(){return{value:u,done:!0}}return p.prototype=_.constructor=y,y.constructor=p,y[r]=p.displayName="GeneratorFunction",i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,r in t||(t[r]="GeneratorFunction")),t.prototype=Object.create(_),t},i.awrap=function(t){return{__await:t}},L(E.prototype),E.prototype[n]=function(){return this},i.AsyncIterator=E,i.async=function(t,e,n,r){var o=new E(a(t,e,n,r));return i.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},L(_),_[r]="Generator",_[o]=function(){return this},_.toString=function(){return"[object Generator]"},i.keys=function(n){var r=[];for(var t in n)r.push(t);return r.reverse(),function t(){for(;r.length;){var e=r.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},i.values=T,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&l.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=u)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function t(t,e){return i.type="throw",i.arg=n,r.next=t,e&&(r.method="next",r.arg=u),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e],i=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var a=l.call(o,"catchLoc"),c=l.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&l.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;S(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=u),v}},i}(t.exports);try{regeneratorRuntime=r}catch(t){Function("r","regeneratorRuntime = r")(r)}},5:function(t,e,n){"use strict";n.r(e);n(3);function u(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}var a=function(){function t(){r(this,t)}var e;return i(t,[{key:"open",value:function(t){t.stopPropagation();var e=t.target.nextSibling,n=e.nextSibling;e.classList.toggle("album__del_show"),n.classList.toggle("album__edit_show")}},{key:"close",value:function(t){var e=t.target.querySelector(".album__del"),n=t.target.querySelector(".album__edit");e.classList.remove("album__del_show"),n.classList.remove("album__edit_show")}},{key:"albumRemove",value:function(t){if(confirm("Are you sure you want to delete album '".concat(t.firstChild.textContent,"'?\n        This operation cannot be undone."))){var e=l.getAlbum(t).id,n=l.getAlbum(t).album,r=l.getAlbum(t).label;this.mail={id:e},this.method="DELETE",this.send().then(function(t){var e=new O(-t);console.log(t),e.setGenCount(),n.remove(),r.remove()},function(t){return console.log(t)})}}},{key:"albumRename",value:function(e,n){var r=this;if(e.classList.toggle("album__title_edit"),this.isEdited)this.setName(e,n);else{e.removeEventListener("mouseleave",this.close),n.src="/svg/checked.svg";var t=document.querySelector(".input-buffer");this.nameNode=e.firstChild,this.name=this.nameNode.textContent,this.input=document.createElement("input"),this.input.className="album__name",this.input.style.background="#C0C0C0",t.classList.add("album__name"),this.input.value=this.name;var o=this.nameNode.offsetWidth;this.input.style.width=o+"px",this.input.oninput=function(){t.innerHTML=r.input.value,r.input.style.width=t.offsetWidth+"px"},this.input.onkeyup=function(t){"Enter"===t.key&&r.setName(e,n)},e.prepend(this.input),this.input.focus(),this.nameNode.hidden=!0,this.isEdited=!0}}},{key:"setName",value:function(t,e){var n=this;e.src="/svg/pencil-edit.svg",this.isEdited=!1,this.nameNode.innerHTML=this.input.value,this.mail={album:t.parentNode.id,newName:this.input.value},this.method="POST",this.input.remove(),this.input=null,this.nameNode.hidden=!1,t.addEventListener("mouseleave",this.close),this.send().then(null,function(){n.nameNode.innerHTML=n.mail.newName})}},{key:"send",value:(e=function(c){return function(){var t=this,a=arguments;return new Promise(function(e,n){var r=c.apply(t,a);function o(t){u(r,e,n,o,i,"next",t)}function i(t){u(r,e,n,o,i,"throw",t)}o(void 0)})}}(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("/album",{method:this.method,headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(this.mail)}).then(function(t){if(200!=t.status)throw console.warn("server trouble"),t.text().then(function(t){return console.log(t)}),t.status;return t.text()}).then(function(t){e.res=t});case 3:t.next=8;break;case 5:throw t.prev=5,t.t0=t.catch(0),new Error(t.t0);case 8:case"end":return t.stop()}},t,this,[[0,5]])})),function(){return e.apply(this,arguments)})}]),t}();function c(t){t.stopPropagation(),t.target.classList.contains("album__edit")?s.albumRename(this,t.target):t.target.classList.contains("album__del")?s.albumRemove(this):this.classList.contains("album__title_active")?l.hide(this):l.show(this)}var l=new(function(){function t(){r(this,t)}return i(t,[{key:"getAlbum",value:function(t){var e=t.parentNode,n=e.id,r=document.getElementsByName(n)[0];r.firstElementChild;return{id:n,album:e,label:r}}},{key:"show",value:function(t){this.elem&&this.elem.classList.remove("album__title_active"),grid(),l.getAlbum(t),this.elem.classList.add("album__title_active"),this.albumGrid=album.lastChild;var e=this.elem.querySelector(".album__count").textContent;this.count=parseInt(e.substring(1)),this.cells=albumGrid.children,18<this.count&&this.cells.length!=this.count&&l.getFiles(),this.startValue=slider.value,slider.removeEventListener("input",grid),slider.addEventListener("input",l.scale);var n=new Event("input");slider.dispatchEvent(n),menuInput.checked=!0;var r=new Event("click");menuLabel.dispatchEvent(r);var o=this.elem.previousSibling.name;document.location.href="#".concat(o,"i")}},{key:"scale",value:function(t){this.val=t.target.value,this.size=gridScale(val);var e=!0,n=!1,r=void 0;try{for(var o,i=this.cells[Symbol.iterator]();!(e=(o=i.next()).done);e=!0)cell=o.value,cell.style.display="block"}catch(t){n=!0,r=t}finally{try{e||null==i.return||i.return()}finally{if(n)throw r}}var a=count/size.col;a=Math.ceil(a),albumGrid.style.gridTemplateColumns="repeat(".concat(size.col,",1fr)"),albumGrid.style.gridTemplateRows="repeat(".concat(a," ,").concat(size.vw,"vw)")}},{key:"getFiles",value:function(){var t="/album/".concat(this.id);fetchGet(t,l.callback)}},{key:"callback",value:function(t){var e=document.createElement("div");e.innerHTML=t;var n=!0,r=!1,o=void 0;try{for(var i,a=e.children[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){node=i.value;var c=node.cloneNode(!0);this.albumGrid.append(c)}}catch(t){r=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}e.remove(),e=null}},{key:"hide",value:function(){this.elem.classList.toggle("album__title_active"),slider.removeEventListener("input",l.scale),slider.addEventListener("input",grid),slider.value=+grid(),fillLine.style.width=slider.value+"px",menuInput.checked=!1}}]),t}()),s=new a;function d(t){var e=t.querySelectorAll(".album__settings");t.querySelectorAll(".album__title").forEach(function(t){t.addEventListener("click",c,!1),t.addEventListener("mouseleave",s.close)}),e.forEach(function(t){t.addEventListener("click",s.open)})}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}d(document.documentElement);var v=document.querySelector(".scale__slider"),p=document.querySelector(".scale_slider-fill"),y=document.querySelector(".sidebar-button"),g=document.querySelector(".sidebar"),b=document.querySelector(".content"),w=document.querySelector(".upload-button"),_=document.querySelector(".menu__button"),L=document.querySelector(".menu__new-album"),E=document.querySelector(".logout-button"),x=document.querySelectorAll(".album__grid"),k=[];function q(t,e,n,r){var o=new FormData,i=[];o.append("id",r),m(t).forEach(function(t){return i.push(t)}),i.forEach(function(t){return o.append("file",t)}),fetch(e,{method:"POST",body:o}).then(function(t){if(200===t.status)return t.text();console.log("Looks like there was a problem. Status Code: "+t.status),300===t.status&&(alert("too many files"),console.log(t))}).then(n)}v.addEventListener("input",function(t){p.style.width=t.target.value}),/Firefox/i.test(navigator.userAgent)&&(p.style.display="none");var S,M=(S="50",function(t){var s=function(t){var e={};switch(t){case"0":e.col=6,e.vw=7.5;break;case"25":e.col=5,e.vw=10;break;case"50":e.col=4,e.vw=12.5;break;case"75":e.col=3,e.vw=16;break;case"100":e.col=2,e.vw=22}return e}(S="object"==f(t)?t.target.value:S);return x.forEach(function(t){var e=2,n=t.children,r=!0,o=!1,i=void 0;try{for(var a,c=n[Symbol.iterator]();!(r=(a=c.next()).done);r=!0)a.value.style.display="block"}catch(t){o=!0,i=t}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}if(s.col<=4)if(n.length>2*s.col)for(var u=2*s.col;u<n.length;u++)n[u].style.display="none";else e=n.length/s.col||1,e=Math.ceil(e);else if(5==s.col||6==s.col)if(e=3,n.length>3*s.col)for(var l=3*s.col;l<n.length;l++)n[l].style.display="none";else e=n.length/s.col,e=Math.ceil(e);t.style.gridTemplateColumns="repeat(".concat(s.col,",1fr)"),t.style.gridTemplateRows="repeat(".concat(e," ,").concat(s.vw,"vw)")}),S});function T(){g.classList.add("sidebar_hide"),b.style.display="flex",y.removeEventListener("click",T),y.addEventListener("click",C)}function C(){g.classList.remove("sidebar_hide"),b.style.display="none",y.removeEventListener("click",C),y.addEventListener("click",T)}function N(){x.forEach(function(t){j(t)}),w.removeEventListener("click",N),w.addEventListener("click",P)}function j(c){var t=document.createElement("div");t.classList.add("upload-area"),t.innerHTML="DRAG FILES HERE",c.prepend(t),k.push(t);var e=document.createElement("input");e.setAttribute("type","file"),e.className="upload-area__input",e.setAttribute("accept",".jpg, .jpeg, .png"),e.multiple=!0,t.append(e);A(t,"upload/",function(t){P();var e=document.createElement("div");e.innerHTML+=t;for(var n=e.children,r=n.length,o=0;o<r;o++)c.prepend(n[0]);var i=new O(r);i.setGenCount(),i.setCount(c);var a=new Event("input");v.dispatchEvent(a)},c.parentNode.id)}v.addEventListener("input",M),window.onload=M(),y.addEventListener("click",T),w.addEventListener("click",N);var O=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.count=t}return function(t,e,n){e&&h(t.prototype,e),n&&h(t,n)}(e,[{key:"setGenCount",value:function(){this.node=document.querySelector(".profile__count"),this.node.innerHTML="".concat(this.count+ +this.prevCount()," files")}},{key:"setCount",value:function(t){this.node=t.parentNode.querySelector(".album__count"),this.node.innerHTML="(".concat(this.count+ +this.prevCount()," photos)")}},{key:"prevCount",value:function(){return this.node.innerHTML.replace(/\D/g,"")}}]),e}();function A(e,n,r,o){function i(t){t.preventDefault(),t.stopPropagation()}function a(t){e.classList.add("upload-area_highlight")}function c(t){e.classList.remove("upload-area_highlight")}r=r||null,o=o||null,["dragenter","dragover","dragleave","drop"].forEach(function(t){e.addEventListener(t,i,!1)}),["dragenter","dragover"].forEach(function(t){e.addEventListener(t,a,!1)}),["dragleave","drop"].forEach(function(t){e.addEventListener(t,c,!1)}),e.addEventListener("drop",function(t){e.innerHTML='<div class="lds-grid"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>',q(t.dataTransfer.files,n,r,o)},!1)}function P(){k.forEach(function(t){t.remove()}),k=[],w.addEventListener("click",N)}function G(){_.removeEventListener("click",G),_.addEventListener("click",H),L.addEventListener("keydown",R),L.style.display="block",L.focus()}function H(){L.style.display="none",_.removeEventListener("click",H),_.addEventListener("click",G)}function R(t){var e=t.target.value.trim();if("Enter"===t.key){H();var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e})};fetch("/create",n).then(function(t){return 200!==t.status?void console.warn("Looks like a problem. Status Code: ".concat(t.status)):t.text()}).then(function(t){!function(t,e){var n=document.querySelector(".album"),r=n?+n.firstChild.name+1:0,o=document.querySelector(".actions"),i=document.createElement("div");i.innerHTML=e;var a=i.firstChild.id;i.querySelector(".album__anchor").name=r;var c=i.querySelector(".album__grid");d(i.firstChild),o.after(i.firstChild),j(c),x=document.querySelectorAll(".album__grid"),i.innerHTML='<label class="menu__option"id="'.concat(r,'i" name="').concat(a,'"onclick="document.location.href=\'#').concat(r,"'\" >").concat(t,'\n        <input class="menu__input" type="radio" name="albums">\n        <span class="checkmark"></span></label>'),L.after(i.firstChild)}(e,t)}),t.target.value="",t.target.removeEventListener("keydown",R)}}function F(t){var e=document.querySelector(".box-wrapper");t&&t.target!==e||(e.remove(),e=null)}_.addEventListener("click",G),E.addEventListener("click",function(){fetch("user/logout",{method:"GET"}).then(function(t){200===t.status?window.location.href=t.url:console.warn("Looks like a problem. Status Code: ".concat(t.status))})}),document.querySelector(".profile__avatar-button").addEventListener("click",function(){!function(t,e,n){fetch(t,{method:n||"GET"}).then(function(t){return 200!==t.status?void console.warn("Looks like a problem. Status Code: ".concat(t.status)):t.text()}).then(e)}("redactor",function e(t){var n=document.createElement("div");n.className="box-wrapper",n.innerHTML=t,document.body.prepend(n),n.addEventListener("mousedown",F),n.addEventListener("wheel",function(t){return t.preventDefault()},!1);var p=document.querySelector(".photo-redactor__img"),y=document.querySelector(".photo-redactor__img_fade"),g=document.querySelector(".photo-redactor__cropper"),b=document.querySelector(".photo-redactor__cropper_circle"),w=document.querySelector(".photo-redactor"),_=document.querySelector(".photo-redactor__thumb_LT"),L=document.querySelector(".photo-redactor__thumb_RT"),E=document.querySelector(".photo-redactor__thumb_LB"),x=document.querySelector(".photo-redactor__thumb_RB"),r=100,k=0,S=0,M=0,T=0,o=w.offsetWidth,i=w.offsetHeight;function a(t){var e=y.offsetLeft,r=t.clientX-e;function n(t){var e=t.clientX-r,n=Math.max(Math.min(e,0),w.clientWidth-y.clientWidth);y.style.left=n+"px",d(k=n,M),document.onmouseup=function(){document.onmousemove=null}}n(t),document.onmousemove=function(t){n(t)}}function c(t){var e=y.offsetTop,r=t.clientY-e;function n(t){var e=t.clientY-r,n=Math.max(Math.min(e,0),w.clientHeight-y.clientHeight);y.style.top=n+"px",h(S=n,T),document.onmouseup=function(){document.onmousemove=null}}n(t),document.onmousemove=function(t){n(t)}}function d(t,e){p.style.left=t+e+"px"}function h(t,e){p.style.top=t+e+"px"}p.onload=function(t){r=t.target.naturalWidth,t.target.naturalHeight<r?(y.style.height="100%",y.style.width="auto",p.style.height=i+"px",p.style.width="auto",y.addEventListener("mousedown",a)):(y.style.width="100%",y.style.height="auto",p.style.width=o+"px",p.style.height="auto",y.addEventListener("mousedown",c))},g.onmousedown=function(t){var f=g.offsetLeft,m=g.offsetTop,v=g.clientWidth;if(t.target===p){var i=w.getBoundingClientRect().left,a=w.clientWidth,c=w.getBoundingClientRect().top,u=w.clientHeight,e=g.getBoundingClientRect().left,n=g.getBoundingClientRect().top,r=t.clientX,o=t.clientY,l=r-e,s=o-n;document.onmousemove=function(t){!function(t){var e=t.clientX,n=t.clientY,r=e-i-l;r=Math.max(Math.min(r,a-v),0),g.style.left=r+"px";var o=n-c-s;o=Math.max(Math.min(o,u-v),0),g.style.top=o+"px",d(k,M=-r),h(S,T=-o),document.onmouseup=function(){document.onmousemove=null}}(t)}}else!function(){var a=t.clientX,c=t.clientY,u=w.offsetWidth,l=u-f-v,s=u-m-v,d=0;function h(t,e,n,r){g.style.left=t+"px",g.style.top=e+"px",p.style.left=-t- -k+"px",p.style.top=-e- -S+"px",g.style.width=Math.min(n,r)+"px",g.style.height=Math.min(n,r)+"px",b.style.width=Math.min(n,r)+"px",b.style.height=Math.min(n,r)+"px"}t.target==_&&(document.onmousemove=function(t){y.style.cursor="nw-resize";var e=a-t.clientX,n=c-t.clientY;d=Math.max(e,n);var r=f-d,o=m-d,i=v+d;h(Math.min(Math.max(r,Math.max(f-m,0)),u-l-80),Math.min(Math.max(o,Math.max(m-f,0)),u-s-80),Math.min(u-l,Math.max(i,80)),Math.min(u-s,Math.max(i,80)))}),t.target==L&&(document.onmousemove=function(t){y.style.cursor="ne-resize";var e=t.clientX-a,n=c-t.clientY;d=Math.max(e,n);var r=m-d,o=v+d,i=f;h(i,Math.min(Math.max(r,Math.max(m-l,0)),u-s-80),Math.min(u-i,Math.max(o,80)),Math.min(u-s,Math.max(o,80)))}),t.target==x&&(document.onmousemove=function(t){y.style.cursor="se-resize";var e=t.clientX-a,n=t.clientY-c;d=Math.max(e,n);var r=f,o=m,i=v+d;h(r,o,Math.min(u-r,Math.max(i,80)),Math.min(u-o,Math.max(i,80)))}),t.target==E&&(document.onmousemove=function(t){y.style.cursor="sw-resize";var e=a-t.clientX,n=t.clientY-c;d=Math.max(e,n);var r=f-d,o=m,i=v+d;h(Math.min(Math.max(r,Math.max(f-s,0)),u-l-80),o,Math.min(u-l,Math.max(i,80)),Math.min(u-o,Math.max(i,80)))}),document.onmouseup=function(){y.style.cursor="grab",t.target!=_&&t.target!=E||(M+=d),t.target!=_&&t.target!=L||(T+=d),document.onmousemove=null}}()};var u=document.querySelector(".inputfile[type=file]"),l=document.querySelector(".avatar-drop-area"),s="/redactor/upload";A(l,s,function(t){t&&(F(),e(t))}),u.oninput=function(t){q(t.srcElement.files,s,function(t){t&&(F(),e(t))})},document.querySelector(".inputfile[type=submit]").onclick=function(){var t=function(){var t={},e=r/p.clientWidth;return t.width=g.clientWidth*e,t.left=(g.offsetLeft-y.offsetLeft)*e,t.top=(g.offsetTop-y.offsetTop)*e,t}();fetch("/redactor/save",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(t){if(201==t.status){var e=document.querySelector(".profile__avatar"),n=(1e10*Math.random()).toString(32);e.src="/redactor/avatar/".concat(n),F()}})}})}),document.ondragstart=function(){return!1}}});